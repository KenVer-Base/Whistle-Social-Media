{% extends 'layout.html' %}
{% block content %}

<div class="position-relative mb-5">
    <div class="bg-secondary" style="height: 200px; background-image: url('{{ url_for('static', filename='uploads/' + user[5]) if user[5] else '' }}'); background-size: cover; background-position: center;"></div>
    
    <div class="position-absolute translate-middle-y ms-3" style="bottom: -70px;">
        <img src="{{ url_for('static', filename='uploads/' + user[4]) if user[4] and user[4] != 'default.png' else 'https://ui-avatars.com/api/?name=' + user[1] + '&background=random&color=fff&size=128&bold=true' }}" 
             class="rounded-circle border border-4 border-dark" 
             style="width: 130px; height: 130px; object-fit: cover; background: #000;"
             onerror="this.src='https://ui-avatars.com/api/?name={{ user[1] }}&background=random&color=fff&size=128&bold=true';">
    </div>
</div>

<div class="d-flex justify-content-end px-3 mb-4">
    <div class="d-flex gap-2">
        {% if session['id'] != user[0] %}
            <a href="{{ url_for('main.chat_room', friend_id=user[0]) }}" class="btn btn-outline-secondary rounded-pill fw-bold">
                <i class="bi bi-envelope"></i>
            </a>

            <a href="{{ url_for('main.follow_user', user_id=user[0]) }}" 
               class="btn rounded-pill fw-bold {{ 'btn-outline-danger' if is_following else 'btn-light text-dark' }}">
                {{ 'Unfollow' if is_following else 'Follow' }}
            </a>
        {% else %}
            <a href="{{ url_for('main.edit_profile') }}" class="btn btn-outline-secondary rounded-pill fw-bold">
                Edit Profil
            </a>
        {% endif %}
    </div>
</div>

<div class="px-3 mb-4">
    <h4 class="fw-bold mb-0">{{ user[7] }}</h4> <p class="text-muted small mb-2">@{{ user[1] }}</p> {% if user[3] %}
        <p class="mb-2">{{ user[3] }}</p> {% endif %}

    <div class="d-flex gap-3 text-muted small">
        <span><strong class="text-white">{{ following }}</strong> Mengikuti</span>
        <span><strong class="text-white">{{ followers }}</strong> Pengikut</span>
        <span><i class="bi bi-calendar3"></i> Bergabung {{ user[6].strftime('%B %Y') }}</span>
    </div>
</div>

<div class="feed-header d-flex justify-content-around border-bottom border-dark mb-2">
    <div class="p-1 border-bottom border-3 border-primary text-white fw-bold">Postingan</div>
</div>

<div class="pb-5">
    {% include 'includes/post_list.html' ignore missing %}
    {% if not posts %}
        <div class="text-center text-muted py-5">
            <p>Belum ada postingan.</p>
        </div>
    {% endif %}
</div>

{% endblock %}